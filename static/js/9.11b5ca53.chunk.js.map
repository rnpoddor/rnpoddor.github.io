{"version":3,"sources":["components/CalcOrderAdditions/connect.js","components/CalcOrderAdditions/styles.js","components/CalcOrderAdditions/index.js","components/CalcOrderAdditions/Additions.js","components/CalcOrderAdditions/AdditionsGroups.js","components/CalcOrderAdditions/AdditionsGroup.js","components/CalcOrderAdditions/AdditionsItem.js"],"names":["ItemData","$p","cat","inserts","alasql_schemas","wsql","alasql","compile","fill_data","ref","items","enm","inserts_types","additions_groups","dp","buyers_order","create","calc_order","doc","by_ref","components","Map","forEach","set","v","production","product_params","_data","_loading","find_rows","ordn","utils","blank","guid","row","characteristic","insert_type","origin","cmp","get","empty","indexOf","elm","count","params","param","value","add","inset","clr","len","height","width","quantity","note","ProductionRow","find_inset","_inset","find","available","mapStateToProps","state","props","handleCalck","additions","process_add_product_list","then","Promise","all","ax","sync_grid","dialog","wnd","elmnts","grids","handleCancel","handlers","handleIfaceState","component","name","compose","connect","styles","paper","minWidth","maxHeight","entered","minHeight","secondary","marginTop","theme","spacing","unit","groupTitle","fontWeight","listitem","paddingTop","paddingBottom","withStyles","CalcOrderAdditions","context","handleOk","bind","classes","el","propTypes","PropTypes","object","isRequired","func","AdditionsGroups","inset_change","obj","fields","groups","_owner","group","forceUpdate","schemas","docs","scheme_settings","item","setState","call","fill_schemas","on","off","map","React","Component","AdditionsGroup","handleAdd","handleRemove","Renderer","scheme","meta","presentation","style","flex","pieces","filter","reduce","sum","primary","tabular","onRowUpdated","onCellSelected","_tabular","value_change","msg","show_msg","type","text","title","selected","_grid","rowGetter","hasOwnProperty","rowIdx","calc_order_row","del","e","updated","clrs","selection_exclude_service","choice_params","length","path","in","some","_columns","column","idx","key","mf","is_guid","tune","number","AdditionsItem","tref"],"mappings":"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","file":"static/js/9.11b5ca53.chunk.js","sourcesContent":["/**\r\n * ### Форма добавления услуг и комплектуюущих\r\n * обработчики событий и модификаторы данных\r\n *\r\n * Created by Evgeniy Malyarov on 13.11.2017.\r\n */\r\n\r\nimport {connect} from 'react-redux';\r\nimport withStyles from './styles';\r\nimport compose from 'recompose/compose';\r\n\r\nimport AdditionsItem from './AdditionsItem';\r\nconst {ItemData} = $p.cat.inserts;\r\n\r\n// компилированный запрос для поиска настроек в ОЗУ\r\nexport const alasql_schemas = $p.wsql.alasql.compile('select * from cat_scheme_settings where obj=\"dp.buyers_order.production\"');\r\n\r\n\r\n// заполняет компонент данными\r\nexport function fill_data(ref) {\r\n\r\n  const items = this.items = $p.enm.inserts_types.additions_groups;\r\n  const dp = this.dp = $p.dp.buyers_order.create();\r\n  dp.calc_order = $p.doc.calc_order.by_ref[ref];\r\n  const components = this.components = new Map();\r\n  items.forEach(v => components.set(v, new ItemData(v, AdditionsItem)));\r\n\r\n  const {production, product_params} = dp;\r\n\r\n  // фильтруем по пустой ведущей продукции\r\n  dp._data._loading = true;\r\n  dp.calc_order.production.find_rows({ordn: $p.utils.blank.guid}, (row) => {\r\n    const {characteristic} = row;\r\n    const {insert_type} = characteristic.origin;\r\n    const cmp = components.get(insert_type);\r\n    // фильтруем по типу вставки\r\n    if(!characteristic.empty() && !characteristic.origin.empty() && items.indexOf(insert_type) != -1) {\r\n      // добавляем параметры\r\n      const elm = production.count() + 1;\r\n      characteristic.params.forEach(({param, value}) => {\r\n        product_params.add({elm, param, value});\r\n      });\r\n      // добавляем строку продукции\r\n      production.add({\r\n        characteristic,\r\n        inset: characteristic.origin,\r\n        clr: characteristic.clr,\r\n        len: row.len,\r\n        height: row.width,\r\n        quantity: row.quantity,\r\n        note: row.note,\r\n      }, false, cmp.ProductionRow);\r\n      // счетчик строк данного типа\r\n      cmp.count++;\r\n    }\r\n  });\r\n  dp._data._loading = false;\r\n}\r\n\r\nexport function find_inset(insert_type) {\r\n  if(!this._inset) {\r\n    this._inset = $p.cat.inserts.find({available: true, insert_type});\r\n  }\r\n  return this._inset;\r\n}\r\n\r\nfunction mapStateToProps(state, props) {\r\n  return {\r\n    handleCalck() {\r\n      const {dp} = this.additions;\r\n      return dp.calc_order.process_add_product_list(dp)\r\n        .then(ax => Promise.all(ax))\r\n        .then(() => {\r\n          dp.calc_order.production.sync_grid(props.dialog.wnd.elmnts.grids.production);\r\n        });\r\n    },\r\n    handleCancel() {\r\n      props.handlers.handleIfaceState({\r\n        component: 'DataObjPage',\r\n        name: 'dialog',\r\n        value: null,\r\n      });\r\n    }\r\n  };\r\n}\r\n\r\n// function mapDispatchToProps(dispatch) {\r\n//   return {};\r\n// }\r\n\r\nexport default compose(\r\n  withStyles,\r\n  connect(mapStateToProps /*, mapDispatchToProps */),\r\n);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/CalcOrderAdditions/connect.js","/**\r\n * ### Форма добавления услуг и комплектуюущих\r\n * стили оформления\r\n *\r\n * Created by Evgeniy Malyarov on 13.11.2017.\r\n */\r\n\r\nimport {withStyles} from 'material-ui/styles';\r\n\r\nconst styles = theme => ({\r\n  paper: {\r\n    minWidth: 880,\r\n    maxHeight: 'calc(100vh - 80px)',\r\n  },\r\n  entered: {\r\n    minHeight: 120,\r\n  },\r\n  secondary: {\r\n    marginTop: -theme.spacing.unit * 1.5,\r\n  },\r\n  groupTitle: {\r\n    fontWeight: 'bold',\r\n  },\r\n  listitem: {\r\n    paddingTop: theme.spacing.unit,\r\n    paddingBottom: theme.spacing.unit,\r\n  }\r\n});\r\n\r\nexport default withStyles(styles);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/CalcOrderAdditions/styles.js","import CalcOrderAdditions from './Additions';\r\n\r\nexport default CalcOrderAdditions;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/CalcOrderAdditions/index.js","/**\r\n * ### Форма добавления услуг и комплектуюущих\r\n * каркас компонента - визуальная глупая часть\r\n *\r\n * Created by Evgeniy Malyarov on 13.11.2017.\r\n */\r\n\r\nimport React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Button from 'material-ui/Button';\r\nimport Dialog from 'metadata-react/App/Dialog';\r\nimport AdditionsGroups from './AdditionsGroups';\r\nimport connect from './connect';\r\n\r\nclass CalcOrderAdditions extends Component {\r\n\r\n  constructor(props, context) {\r\n    super(props, context);\r\n    const {handleCancel, handleCalck} = props;\r\n    this.handleCancel = handleCancel.bind(this);\r\n    this.handleCalck = handleCalck.bind(this);\r\n  }\r\n\r\n  handleOk = () => {\r\n    this.handleCalck().then(this.handleCancel);\r\n  };\r\n\r\n  render() {\r\n\r\n    const {handleCancel, handleCalck, handleOk, props} = this;\r\n    const {classes, dialog} = props;\r\n\r\n    return <Dialog\r\n      open\r\n      initFullScreen\r\n      classes={{paper: classes.paper}}\r\n      title=\"Аксессуары и услуги\"\r\n      onClose={handleCancel}\r\n      actions={[\r\n        <Button key=\"ok\" onClick={handleOk} color=\"primary\">Рассчитать и закрыть</Button>,\r\n        <Button key=\"calck\" onClick={handleCalck} color=\"primary\">Рассчитать</Button>,\r\n        <Button key=\"cancel\" onClick={handleCancel} color=\"primary\">Закрыть</Button>\r\n      ]}\r\n    >\r\n      <AdditionsGroups ref={(el) => this.additions = el} dialog={dialog}/>\r\n    </Dialog>;\r\n\r\n  }\r\n}\r\n\r\nCalcOrderAdditions.propTypes = {\r\n  classes: PropTypes.object.isRequired,\r\n  dialog: PropTypes.object.isRequired,\r\n  handlers: PropTypes.object.isRequired,\r\n  handleCalck: PropTypes.func.isRequired,\r\n  handleCancel: PropTypes.func.isRequired,\r\n};\r\n\r\nexport default connect(CalcOrderAdditions);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/CalcOrderAdditions/Additions.js","/**\r\n * ### Форма добавления услуг и комплектуюущих\r\n * список групп (подоконники, услуги и т.д.)\r\n * Здесь есть немного работы с данными - создаём экземпляр обработки, находим варианты настроек\r\n *\r\n * Created by Evgeniy Malyarov on 13.11.2017.\r\n */\r\n\r\nimport React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport List, {ListItem, ListItemText} from 'material-ui/List';\r\nimport AdditionsGroup from './AdditionsGroup';\r\nimport {alasql_schemas, fill_data} from './connect';\r\n\r\n\r\nexport default class AdditionsGroups extends React.Component {\r\n\r\n  constructor(props, context) {\r\n    super(props, context);\r\n\r\n    this.state = {schemas: null};\r\n    this.groups = new Map();\r\n  }\r\n\r\n  // заполняет соответствие схем и типов вставок в state компонента\r\n  fill_schemas(docs = []) {\r\n    const schemas = new Map();\r\n    const {scheme_settings} = $p.cat;\r\n    for (const doc of docs) {\r\n      for (const item of this.items) {\r\n        if(item && doc.name == item.name) {\r\n          schemas.set(item, scheme_settings.get(doc));\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    this.setState({schemas});\r\n  }\r\n\r\n  componentWillMount() {\r\n    fill_data.call(this, this.props.dialog.ref);\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.fill_schemas(alasql_schemas());\r\n    $p.dp.buyers_order.on('update', this.inset_change);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    $p.dp.buyers_order.off('update', this.inset_change);\r\n  }\r\n\r\n  inset_change = (obj, fields) => {\r\n    const {groups, dp} = this;\r\n    if(fields && fields.inset && obj._owner == dp.production) {\r\n      const group = groups.get(obj.inset.insert_type);\r\n      group && group.forceUpdate();\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const {items, components, dp} = this;\r\n    const {schemas} = this.state || {};\r\n\r\n    return <List>\r\n      {schemas ?\r\n        items.map(group => {\r\n          if(!group) {\r\n            return null;\r\n          }\r\n          const cmp = components.get(group);\r\n          return <AdditionsGroup\r\n            key={`${group.ref}`}\r\n            ref={el => this.groups.set(group, el)}\r\n            dp={dp}\r\n            group={group}\r\n            {...cmp}\r\n            scheme={schemas.get(group)}\r\n          />;\r\n\r\n        })\r\n        :\r\n        <ListItem>\r\n          <ListItemText primary=\"Чтение настроек компоновки...\"/>\r\n        </ListItem>\r\n      }\r\n    </List>;\r\n  }\r\n\r\n}\r\n\r\nAdditionsGroups.propTypes = {\r\n  dialog: PropTypes.object.isRequired,\r\n};\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/CalcOrderAdditions/AdditionsGroups.js","/**\r\n * ### Форма добавления услуг и комплектуюущих\r\n * список элементов группы - конкретные подоконники, отливы и т.д.\r\n *\r\n * Created by Evgeniy Malyarov on 13.11.2017.\r\n */\r\n\r\nimport React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport {ListItem, ListItemSecondaryAction, ListItemText} from 'material-ui/List';\r\nimport IconButton from 'material-ui/IconButton';\r\nimport AddIcon from '@material-ui/icons/AddCircleOutline';\r\nimport RemoveIcon from '@material-ui/icons/Delete';\r\nimport Divider from 'material-ui/Divider';\r\nimport Collapse from 'material-ui/transitions/Collapse';\r\nimport {find_inset} from './connect';\r\nimport withStyles from './styles';\r\n\r\n\r\nclass AdditionsGroup extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {count: props.count};\r\n  }\r\n\r\n  handleAdd = () => {\r\n    const {tabular, props} = this;\r\n    const inset = find_inset.call(this, props.group);\r\n    if(inset && tabular) {\r\n      const {_data} = tabular.state._tabular._owner;\r\n      _data._loading = true;\r\n      const row = tabular.state._tabular.add({inset, quantity: 1}, false, props.ProductionRow);\r\n      _data._loading = false;\r\n      row.value_change('inset', 'force', row.inset);\r\n      this.setState({\r\n        count: this.state.count + 1,\r\n      });\r\n    }\r\n    else {\r\n      $p.msg.show_msg({\r\n        type: 'alert-info',\r\n        text: `Нет вставки подходящего типа (${props.group})`,\r\n        title: 'Новая строка'\r\n      });\r\n    }\r\n  };\r\n\r\n  handleRemove = () => {\r\n    const {props, tabular, state} = this;\r\n    if(tabular){\r\n      const {selected} = tabular._grid.state;\r\n      const row = tabular.rowGetter(selected && selected.hasOwnProperty('rowIdx') ? selected.rowIdx : 0);\r\n      if(row){\r\n        const {calc_order_row} = row.characteristic;\r\n        row._owner.del(row);\r\n        tabular.forceUpdate();\r\n        if(state.count) {\r\n          this.setState({\r\n            count: state.count - 1,\r\n          });\r\n        }\r\n        if(calc_order_row){\r\n          calc_order_row._owner.del(calc_order_row);\r\n        }\r\n      }\r\n      else{\r\n        $p.msg.show_msg({\r\n          type: 'alert-info',\r\n          text: `Укажите строку для удаления (${props.group})`,\r\n          title: 'Удаление строки'\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  onRowUpdated = (e, row) => {\r\n    if(e && e.updated.hasOwnProperty('inset')){\r\n      const {meta} = this.props;\r\n      $p.cat.clrs.selection_exclude_service(meta.fields.clr, row.inset);\r\n      if(!row.clr.empty()){\r\n        const filter = meta.fields.clr.choice_params.filter(({name}) =>  name === 'ref');\r\n        if(filter.length) {\r\n          if(filter[0].path.in && !filter[0].path.in.some(v => v == row.clr)){\r\n            row.clr = filter[0].path.in[0];\r\n            this.forceUpdate();\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  onCellSelected = (e) => {\r\n    const {props: {meta}, tabular} = this;\r\n    if(tabular && tabular.state._columns){\r\n      const column = tabular.state._columns[e.idx];\r\n      const {key} = column;\r\n      const row = tabular.rowGetter(e.rowIdx);\r\n      const mf = meta.fields[key];\r\n      if(key === 'clr') {\r\n        $p.cat.clrs.selection_exclude_service(mf, row.inset);\r\n      }\r\n      else if($p.utils.is_guid(key)) {\r\n        row.tune(key, mf, column);\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  render() {\r\n\r\n    const {props, state: {count}, handleAdd, handleRemove} = this;\r\n    const {Renderer, group, dp, classes, scheme, meta} = props;\r\n    const {ref, presentation} = group;\r\n    const style = {flex: 'initial'};\r\n    if(count) {\r\n      style.minHeight = 80 + (33 * (count - 1));\r\n      //style.maxHeight = 320;\r\n    }\r\n\r\n    function pieces() {\r\n      return scheme.filter(dp.production).reduce((sum, row) => sum + row.quantity, 0);\r\n    }\r\n\r\n    return <div style={style}>\r\n      <ListItem disableGutters className={classes.listitem}>\r\n        <IconButton title=\"Добавить строку\" onClick={handleAdd}><AddIcon/></IconButton>\r\n        <IconButton title=\"Удалить строку\" disabled={!count} onClick={handleRemove}><RemoveIcon/></IconButton>\r\n        <ListItemText classes={count ? {primary: classes.groupTitle} : {}} primary={presentation}/>\r\n        <ListItemSecondaryAction className={classes.secondary}>{count ? `${pieces()} шт` : ''}</ListItemSecondaryAction>\r\n      </ListItem>\r\n\r\n      <Collapse in={!!count} timeout={100} classes={{entered: classes.entered}}>\r\n        <div style={{height: (style.minHeight || 0) + 35}}>\r\n          <Renderer\r\n            tref={(el) => this.tabular = el}\r\n            minHeight={style.minHeight}\r\n            dp={dp}\r\n            group={group}\r\n            scheme={scheme}\r\n            meta={meta}\r\n            onRowUpdated={this.onRowUpdated}\r\n            onCellSelected={this.onCellSelected}\r\n          />\r\n        </div>\r\n      </Collapse>\r\n\r\n      {!count && <Divider key={`d${ref}`}/>}\r\n\r\n    </div>;\r\n  }\r\n\r\n}\r\n\r\nAdditionsGroup.propTypes = {\r\n  dp: PropTypes.object.isRequired,\r\n  group: PropTypes.object.isRequired,\r\n  scheme: PropTypes.object.isRequired,\r\n  meta: PropTypes.object.isRequired,\r\n  count: PropTypes.number.isRequired,\r\n  Renderer: PropTypes.func,\r\n};\r\n\r\nexport default withStyles(AdditionsGroup);\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/CalcOrderAdditions/AdditionsGroup.js","/**\r\n * ### Форма добавления услуг и комплектуюущих\r\n * Абстрактная строка допвставки - от неё наследуются строки подоконников, отливов и т.д.\r\n *\r\n * Created by Evgeniy Malyarov on 13.11.2017.\r\n */\r\n\r\nimport React, {Component} from 'react';\r\nimport PropTypes from 'prop-types';\r\n//import {FormGroup} from 'material-ui/Form';\r\nimport TabularSection from 'metadata-react/TabularSection';\r\n\r\nexport default class AdditionsItem extends Component {\r\n\r\n  render() {\r\n    const {dp, meta, scheme, tref, onRowUpdated, onCellSelected, minHeight} = this.props;\r\n\r\n    return <TabularSection\r\n      ref={tref}\r\n      _obj={dp}\r\n      _meta={meta}\r\n      _tabular=\"production\"\r\n      scheme={scheme}\r\n      onRowUpdated={onRowUpdated}\r\n      onCellSelected={onCellSelected}\r\n      minHeight={minHeight}\r\n      hideToolbar\r\n    />;\r\n  }\r\n\r\n}\r\n\r\nAdditionsItem.propTypes = {\r\n  dp: PropTypes.object.isRequired,\r\n  scheme: PropTypes.object.isRequired,\r\n  meta: PropTypes.object.isRequired,\r\n  tref: PropTypes.func.isRequired,\r\n  onRowUpdated: PropTypes.func.isRequired,\r\n  onCellSelected: PropTypes.func.isRequired,\r\n  minHeight: PropTypes.number,\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/CalcOrderAdditions/AdditionsItem.js"],"sourceRoot":""}